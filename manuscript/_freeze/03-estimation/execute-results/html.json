{
  "hash": "ef37b28f46c3f9884f59fc45d524af6a",
  "result": {
    "engine": "knitr",
    "markdown": "# Estimation\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Calibration\n\nFor calibration, I use the parameter values in @greenwood2009, summarized in @tbl-params-gg09. Some parameters are set from a priori information: $\\tilde{\\beta} = 0.96$ (convention), $\\phi = 0.766$ (OECD equivalence scale), $\\theta = 0.206$ and $\\kappa = 0.189$ [@mcgrattan1997], and $1/\\delta = 47$ (marriageable life span, ages 18--64). The wage $w_{1950}$ is normalized to 1, with a growth rate $\\Delta w = 0.022$ matching the real wage trend from the data. The remaining ten parameters, taste parameters $(\\alpha, \\zeta, \\bar{c})$, price parameters $(p_{1950}, \\gamma)$, and match quality parameters $(\\mu_s, \\sigma_s, \\mu_m, \\sigma_m, \\varrho)$, are jointly estimated by minimum distance, targeting 16 data observations across five dimensions: time allocations for married and single households (1950--1990), the fraction married, divorce rate, and marriage rate (1950 and 2000). Importantly, the match quality parameters do not enter the labor supply functions, so they are effectively identified from the vital statistics targets alone.\n\n\n::: {#tbl-params-gg09 .cell layout-align=\"center\" tbl-cap='**Parameter Values in @greenwood2009**'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <!-- tinytable mathjax start -->\n    <script id=\"MathJax-script\" async src=\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"></script>\n    <script>\n    MathJax = {\n      tex: {\n        inlineMath: [['$', '$'], ['\\\\(', '\\\\)']]\n      },\n      svg: {\n        fontCache: 'global'\n      }\n    };\n    </script>\n    <!-- tinytable mathjax end -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_h6o5o3btbbyqa9enw95h = TinyTable.createTableFunctions(\"tinytable_h6o5o3btbbyqa9enw95h\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '8', j: 1 }, { i: '8', j: 2 }, { i: '8', j: 3 } ], css_id: 'tinytable_css_0rqxtfyxm7g51b331ov0',}, \n          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 }, { i: '6', j: 1 }, { i: '7', j: 1 }, { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '6', j: 2 }, { i: '7', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '5', j: 3 }, { i: '6', j: 3 }, { i: '7', j: 3 } ], css_id: 'tinytable_css_0ds93bzznm382zqp8icd',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 } ], css_id: 'tinytable_css_vgjzmkfy1xd6fkng2k7c',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_h6o5o3btbbyqa9enw95h.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_h6o5o3btbbyqa9enw95h td.tinytable_css_0rqxtfyxm7g51b331ov0, #tinytable_h6o5o3btbbyqa9enw95h th.tinytable_css_0rqxtfyxm7g51b331ov0 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }\n    #tinytable_h6o5o3btbbyqa9enw95h td.tinytable_css_0ds93bzznm382zqp8icd, #tinytable_h6o5o3btbbyqa9enw95h th.tinytable_css_0ds93bzznm382zqp8icd { text-align: left }\n    #tinytable_h6o5o3btbbyqa9enw95h td.tinytable_css_vgjzmkfy1xd6fkng2k7c, #tinytable_h6o5o3btbbyqa9enw95h th.tinytable_css_vgjzmkfy1xd6fkng2k7c {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_h6o5o3btbbyqa9enw95h\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\"> </th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Parameter</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Description</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">Tastes</td>\n                  <td data-row=\"1\" data-col=\"2\">$\\tilde{\\beta}=0.96, \\phi=0.766$</td>\n                  <td data-row=\"1\" data-col=\"3\">Literature</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\"></td>\n                  <td data-row=\"2\" data-col=\"2\">$\\alpha = 0.278, \\zeta = -1.901, \\overline{c} = 0.131$</td>\n                  <td data-row=\"2\" data-col=\"3\">Estimated</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">Technology</td>\n                  <td data-row=\"3\" data-col=\"2\">$\\theta = 0.206, \\kappa = 0.189$</td>\n                  <td data-row=\"3\" data-col=\"3\">Literature</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">Life span</td>\n                  <td data-row=\"4\" data-col=\"2\">$1/\\delta=47$</td>\n                  <td data-row=\"4\" data-col=\"3\">Settings</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">Shocks</td>\n                  <td data-row=\"5\" data-col=\"2\">$\\mu_s = -4.252, \\sigma_s^2 = 8.063$</td>\n                  <td data-row=\"5\" data-col=\"3\">Estimated</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\"></td>\n                  <td data-row=\"6\" data-col=\"2\">$\\mu_m = 0.521, \\sigma_m^2 = 0.680, \\varrho = 0.896$</td>\n                  <td data-row=\"6\" data-col=\"3\">Estimated</td>\n                </tr>\n                <tr>\n                  <td data-row=\"7\" data-col=\"1\">Prices</td>\n                  <td data-row=\"7\" data-col=\"2\">$p_{1950} = 9.959, \\Delta p = 0.059$</td>\n                  <td data-row=\"7\" data-col=\"3\">Estimated</td>\n                </tr>\n                <tr>\n                  <td data-row=\"8\" data-col=\"1\">Wages</td>\n                  <td data-row=\"8\" data-col=\"2\">$w_{1950} = 1.000, \\Delta w = 0.022$</td>\n                  <td data-row=\"8\" data-col=\"3\">Data</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n**Continuous-time Specific Parameters**\n\nI set the Poisson arrival rate $\\lambda = 1$ and the model period length $\\Delta t = 1$ for the continuous-time model. This choice corresponds exactly to the discrete-time assumption that each single meets one potential partner per period, since the expected number of Poisson arrivals in an interval of length $\\Delta t$ is $\\lambda\\,\\Delta t = 1$. Moreover, the HJB equations depend on rates only through their ratios, so the level of $\\lambda$ is not separately identified; what matters is the product $\\lambda\\,\\Delta t$. Setting $\\lambda = 1/\\Delta t$ fixes this product at unity for any $\\Delta t$, making the choice of period length immaterial.\n\nThe continuous-time method requires additional parameters for the OU process. A naive approach is to set the parameters of the OU process to match the mean and variance of the AR(1) process. However, this approach does not work well in practice because of the *continuous monitoring problem*. In the discrete-time model, the divorce decision is evaluated only once per period: even if the match quality dips below the threshold within the period, the couple remains married as long as the realized end-of-period quality exceeds the threshold. In continuous time, by contrast, the value function is monitored at every instant, so the process can trigger divorce the moment it crosses the threshold---an event that occurs with strictly higher probability. As a result, naively matching the OU parameters $(\\mu_m, \\sigma_m, \\eta)$ to the AR(1) parameters $(\\mu_m, \\sigma_m, \\varrho)$ via the standard mapping $\\eta = -\\log(\\varrho)/\\Delta t$ systematically overstates the divorce rate in the continuous-time formulation.\n\nTo address this issue, I re-estimate the OU parameters $(\\mu_m, \\sigma_m, \\eta)$ by minimum distance, targeting the fraction married, divorce rate, and marriage rate in 1950 and 2000. The resulting parameter values are reported in @tbl-params-ct alongside the naive AR(1)-matched values from @greenwood2009, and the model fit is shown in @tbl-calibration.\n\n\n::: {#tbl-params-ct .cell layout-align=\"center\" tbl-cap='**Additional Parameters for Continuous-time Method**'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <!-- tinytable mathjax start -->\n    <script id=\"MathJax-script\" async src=\"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"></script>\n    <script>\n    MathJax = {\n      tex: {\n        inlineMath: [['$', '$'], ['\\\\(', '\\\\)']]\n      },\n      svg: {\n        fontCache: 'global'\n      }\n    };\n    </script>\n    <!-- tinytable mathjax end -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_sohsjidfhtqwjgaosmdb = TinyTable.createTableFunctions(\"tinytable_sohsjidfhtqwjgaosmdb\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '3', j: 1 }, { i: '3', j: 2 }, { i: '3', j: 3 } ], css_id: 'tinytable_css_30mq9tnnyaj2smx2wg8g',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 } ], css_id: 'tinytable_css_y0r1kxra1t7sjt1gqe9f',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_sohsjidfhtqwjgaosmdb.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_sohsjidfhtqwjgaosmdb td.tinytable_css_30mq9tnnyaj2smx2wg8g, #tinytable_sohsjidfhtqwjgaosmdb th.tinytable_css_30mq9tnnyaj2smx2wg8g {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_sohsjidfhtqwjgaosmdb td.tinytable_css_y0r1kxra1t7sjt1gqe9f, #tinytable_sohsjidfhtqwjgaosmdb th.tinytable_css_y0r1kxra1t7sjt1gqe9f {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_sohsjidfhtqwjgaosmdb\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Parameter</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Greenwood and Guner (2009)</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Estimated</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='3'>The Greenwood and Guner (2009) column uses the original values of $\\mu_m$ and $\\sigma_m^2$ and sets $\\eta = -\\log(\\varrho)/\\Delta t$ with $\\varrho = 0.896$ and $\\Delta t = 1$. The Estimated column shows the values re-estimated by minimum distance targeting the fraction married, divorce rate, and marriage rate in 1950 and 2000.</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">$\\mu_m$</td>\n                  <td data-row=\"1\" data-col=\"2\">0.521</td>\n                  <td data-row=\"1\" data-col=\"3\">0.951</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">$\\sigma_m^2$</td>\n                  <td data-row=\"2\" data-col=\"2\">0.68</td>\n                  <td data-row=\"2\" data-col=\"3\">0.83</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">$\\eta$</td>\n                  <td data-row=\"3\" data-col=\"2\">0.11</td>\n                  <td data-row=\"3\" data-col=\"3\">0.113</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nThe estimated parameters in @tbl-params-ct are consistent with the continuous monitoring effect described above. The mean-reversion speed $\\eta$ hardly changes, but $\\mu_m$ rises from $0.521$ to $0.951$, shifting the match quality distribution away from the divorce boundary to offset the higher crossing probability under continuous monitoring.\n\n## Results\n\nFollowing @greenwood2009, I simulate the model from 1950 to 2020 by increasing the wage $w$ and the price of home goods $p$ at constant annual rates ($\\Delta w = 0.022$ and $\\Delta p = 0.059$; see @tbl-params-gg09). The rising wage raises the opportunity cost of home production, while the falling relative price of home goods makes market substitutes more accessible. Together, these secular trends compress the utility gain from marriage $v(p,w,2) - v(p,w,1)$, as shown in the right panel of @fig-marriage-rate. As the surplus from marriage shrinks, the equilibrium share of married households declines steadily from roughly 80 % in 1950 to below 70 % by 2020 (left panel of @fig-marriage-rate). \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![**Replication of Fig. 6 in @greenwood2009**.](03-estimation_files/figure-html/fig-marriage-rate-1.png){#fig-marriage-rate fig-align='center' width=90%}\n:::\n:::\n\n\n@fig-marriage-divorce-rate decomposes the decline in the married population into its flow components. Both the divorce rate and the marriage rate exhibit the same broad pattern across the CT and DT formulations: the divorce rate rises while the marriage rate falls, consistent with the shrinking marriage surplus. The CT and DT trajectories track each other closely, confirming that the continuous-time reformulation preserves the aggregate dynamics of the original model.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![**Replication of Fig. 7 in @greenwood2009**.](03-estimation_files/figure-html/fig-marriage-divorce-rate-1.png){#fig-marriage-divorce-rate fig-align='center' width=90%}\n:::\n:::\n\n\n**Computational Performance**\n\nAlthough the CT and DT methods produce nearly identical equilibrium outcomes, their computational costs differ markedly. As discussed in @sec-apdx-comp, the DT method requires constructing and iterating on an $N \\times N$ transition matrix, yielding $O(N^2)$ complexity in the number of grid points $N$, whereas the CT method solves tridiagonal systems that scale as $O(N)$. I measure computation time and memory usage with BenchmarkTools.jl [@chen2016] on an Apple M3 Max (16-core, 128 GB RAM). @fig-benchmark plots the results on log--log axes. The DT curves have a slope of approximately 2, and the CT curves have a slope of approximately 1, consistent with the theoretical complexity orders.\n  \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![**Computational Performance of Continuous-Time and Discrete-Time Methods.**](03-estimation_files/figure-html/fig-benchmark-1.png){#fig-benchmark fig-align='center' width=90%}\n:::\n:::\n",
    "supporting": [
      "03-estimation_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}